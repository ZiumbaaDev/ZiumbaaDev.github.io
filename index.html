<body>
    <button onclick="onButtonClick()">Generate</button>
</body>

<script>
    async function onButtonClick() {
        const response = await fetch('BaseNPC.json');
        const example = await response.json();

        example.gender = (["male", "female"])[Math.round(Math.random())];
        example.race = ["human", "halfling", "hill dwarf", "gnome", "human", "human", "human", "human", "human", "mountain dwarf"][Math.floor(Math.random() * 10)];
        example.class = "civilian";
        example.name = "unnamed";

        example.stats.str = 8 + Math.round(Math.random() * 4);
        example.stats.dex = 8 + Math.round(Math.random() * 4);
        example.stats.con = 8 + Math.round(Math.random() * 4);
        example.stats.int = 8 + Math.round(Math.random() * 4);
        example.stats.wis = 8 + Math.round(Math.random() * 4);
        example.stats.cha = 8 + Math.round(Math.random() * 4);

        if(example.race == "human") {
            example.age = Math.round(Math.random() * 52) + 18;
            
            example.stats.str += 1;
            example.stats.dex += 1;
            example.stats.con += 1;
            example.stats.int += 1;
            example.stats.wis += 1;
            example.stats.cha += 1;
        } else if(example.race == "halfling") {
            example.age = Math.round(Math.random() * 100) + 20;
        } else if(example.race == "hill dwarf") {
            example.age = Math.round(Math.random() * 262) + 18;

            example.stats.con += 2;
            example.stats.wis += 1;
        } else if(example.race == "mountain dwarf") {
            example.age = Math.round(Math.random() * 262) + 18;

            example.stats.con += 2;
            example.stats.str += 2;
        } else if(example.race == "gnome") {
            example.age = Math.round(Math.random() * 280) + 40;

            example.stats.int += 2;
            example.stats.con += 1;
        }

        // 3. Convert the modified JSON to a string
        const jsonString = JSON.stringify(example, null, 2);

        // 4. Create a blob and trigger download
        const blob = new Blob([jsonString], { type: 'application/json' });
        const url = URL.createObjectURL(blob);

        const a = document.createElement('a');
        a.href = url;
        a.download = 'output.json';
        a.click();

        URL.revokeObjectURL(url); // Clean up
    }
</script>